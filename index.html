<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover">
<title>Elementix ‚Äî –∞–ª—Ö–∏–º–∏—è</title>
<meta name="color-scheme" content="dark">
<meta name="theme-color" content="#0b0f14">
<style>
:root{--bg:#0b0f14;--panel:#10161d;--panel2:#0b1218;--line:#1f2a39;--ink:#e7ecf4;--muted:#9fb0bf;--accent:#6fb1ff}
*{box-sizing:border-box}
html,body{height:100%;margin:0;color:var(--ink);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Noto Sans",sans-serif}
body{background:radial-gradient(800px 480px at 80% -10%, #172332, #0b0f14)}
.app{min-height:100%;display:flex;flex-direction:column}
.header{position:sticky;top:0;z-index:70;display:flex;align-items:center;gap:10px;height:48px;padding:0 12px;padding-top:calc(env(safe-area-inset-top,0px));border-bottom:1px solid var(--line);background:rgba(11,15,20,.88);backdrop-filter:blur(8px)}
.title{font-weight:800}
.spacer{flex:1}
.stars{display:flex;align-items:center;gap:6px;background:#121b28;border:1px solid #253247;color:#ffd166;border-radius:999px;padding:6px 10px;font-weight:800}
.main{display:flex;flex-direction:column;gap:10px;padding:8px 12px calc(120px + env(safe-area-inset-bottom,0px))}
.crumbs{position:sticky;top:48px;z-index:65;display:flex;gap:10px;align-items:center;overflow-x:auto;padding:8px 6px;background:rgba(11,15,20,.85);backdrop-filter:blur(6px);border:1px solid var(--line);border-radius:12px}
.token{display:grid;place-items:center;width:42px;height:42px;border-radius:50%;background:linear-gradient(180deg,#0f1620,#0b1218);border:1px solid #203043;box-shadow:0 6px 18px rgba(0,0,0,.25)}
.token .emo{font-size:22px}
/* HORIZONTAL bowls */
.bowls{display:grid;grid-template-columns:1fr 1fr;gap:10px}
@media (max-width:359px){.bowls{grid-template-columns:1fr}}
.drop{position:relative;background:var(--panel2);border:1px dashed #2a384b;border-radius:16px;min-height:140px;display:grid;place-items:center;overflow:hidden}
.drop .hint{position:absolute;top:8px;left:12px;color:var(--muted);font-size:12px}
.selection{display:flex;gap:12px;align-items:center;animation:arrive .35s ease-out}
.selection .emoji{font-size:54px;filter:drop-shadow(0 6px 10px rgba(0,0,0,.35))}
.selection .name{font-size:14px;color:#cfe1ff}
@keyframes arrive{0%{transform:translateY(10px) scale(.9);opacity:0}100%{transform:translateY(0) scale(1);opacity:1}}
.tools{position:sticky;top:calc(48px + 56px); z-index:60;background:rgba(11,15,20,.85);backdrop-filter:blur(8px);border:1px solid var(--line);border-radius:12px;padding:8px;display:flex;gap:8px;align-items:center}
.tools input{flex:1;background:#0b1218;border:1px solid var(--line);border-radius:10px;color:#cfe1ff;padding:10px}
.tools .count{font-size:12px;color:#9fb0bf}
.grid{display:grid;grid-template-columns:repeat(auto-fill, minmax(104px,1fr));gap:10px}
.card{background:linear-gradient(180deg,#101821,#0b1218);border:1px solid #1f2a39;border-radius:14px;padding:10px;display:grid;gap:6px;position:relative;cursor:grab}
.emoji{font-size:30px} .name{font-size:12px;color:#cfe1ff}
.tag{position:absolute;top:8px;right:8px;font-size:10px;background:#121b28;border:1px solid #253247;border-radius:999px;padding:2px 6px;color:#9fb0bf}
.dock{position:fixed;left:0;right:0;bottom:0;z-index:80;background:linear-gradient(180deg, rgba(11,15,20,0), rgba(11,15,20,.95));padding:10px 12px calc(12px + env(safe-area-inset-bottom,0px));display:flex;justify-content:center}
.dock .inner{display:grid;grid-template-columns:1fr auto 1fr;gap:10px;align-items:center;max-width:900px;width:100%}
.btn{background:#1b2633;border:1px solid #253247;color:#cfe1ff;border-radius:16px;padding:14px 14px;font-weight:700;cursor:pointer}
.btn.primary{background:#6fb1ff;border:none;color:#07101c;font-weight:900;padding:16px 24px;border-radius:20px;font-size:16px}
#hint{display:flex;flex-direction:column;align-items:center;gap:2px;min-width:132px;padding:12px 14px}
.hline1{font-weight:900}.hline2{font-size:12px;opacity:.9}
.toast{position:fixed;left:50%;bottom:96px;transform:translateX(-50%);background:#0b1218;border:1px solid #1f2a39;color:#cfe1ff;padding:10px 14px;border-radius:12px;opacity:0;animation:pop .9s ease-out forwards;z-index:90}
@keyframes pop{0%{opacity:0;transform:translateX(-50%) translateY(8px)}20%{opacity:1}100%{opacity:1;transform:translateX(-50%) translateY(0)}}
</style>
</head>
<body>
<div class="app" id="app">
  <div class="header">
    <div class="title">Elementix ‚Äî –∞–ª—Ö–∏–º–∏—è</div>
    <div class="spacer"></div>
    <div class="stars">‚≠ê <span id="stars">20</span></div>
    <button id="openJournal" class="btn" style="margin-left:8px">–ñ—É—Ä–Ω–∞–ª</button>
  </div>

  <div class="main">
    <div class="crumbs" id="crumbs"></div>

    <div class="bowls">
      <div class="drop" id="bA"><div class="hint">–ü–µ—Ä–µ—Ç–∞—â–∏ –∏–ª–∏ –∫–ª–∏–∫–Ω–∏ –∫–∞—Ä—Ç–æ—á–∫—É</div></div>
      <div class="drop" id="bB"><div class="hint">–ü–µ—Ä–µ—Ç–∞—â–∏ –∏–ª–∏ –∫–ª–∏–∫–Ω–∏ –∫–∞—Ä—Ç–æ—á–∫—É</div></div>
    </div>

    <div class="tools">
      <input id="search" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∫–æ–ª–ª–µ–∫—Ü–∏–∏‚Ä¶">
      <button id="reset" class="btn">–°–±—Ä–æ—Å</button>
      <div class="count">–û—Ç–∫—Ä—ã—Ç–æ: <span id="openCount">0</span> / <span id="totalCount">0</span> ‚Ä¢ <b style="color:#6fb1ff">v126c</b></div>
    </div>

    <div class="grid" id="grid"></div>
  </div>

  <div class="dock">
    <div class="inner">
      <button id="hint" class="btn"><div class="hline1" id="h1">–ü–æ–¥—Å–∫–∞–∑–∫–∞</div><div class="hline2" id="h2">–±–µ—Å–ø–ª–∞—Ç–Ω–æ</div></button>
      <button id="mix" class="btn primary">–°–º–µ—à–∞—Ç—å</button>
      <button id="clear" class="btn">–û—á–∏—Å—Ç–∏—Ç—å —á–∞—à–∏</button>
    </div>
  </div>
</div>

<script>
const DATA = {"base": [{"id": "fire", "n": "–û–≥–æ–Ω—å", "e": "üî•", "r": "common"}, {"id": "water", "n": "–í–æ–¥–∞", "e": "üíß", "r": "common"}, {"id": "earth", "n": "–ó–µ–º–ª—è", "e": "ü™®", "r": "common"}, {"id": "air", "n": "–í–æ–∑–¥—É—Ö", "e": "üí®", "r": "common"}], "extra": {"plant": {"n": "–†–∞—Å—Ç–µ–Ω–∏–µ", "e": "üåø", "r": "common"}, "tree": {"n": "–î–µ—Ä–µ–≤–æ", "e": "üå≥", "r": "common"}, "seed": {"n": "–°–µ–º–µ–Ω–∞", "e": "üå±", "r": "common"}, "flower": {"n": "–¶–≤–µ—Ç–æ–∫", "e": "üå∏", "r": "common"}, "mushroom": {"n": "–ì—Ä–∏–±", "e": "üçÑ", "r": "common"}, "forest": {"n": "–õ–µ—Å", "e": "üå≤", "r": "common"}, "swamp": {"n": "–ë–æ–ª–æ—Ç–æ", "e": "ü¶†", "r": "common"}, "life": {"n": "–ñ–∏–∑–Ω—å", "e": "üß¨", "r": "common"}, "animal": {"n": "–ñ–∏–≤–æ—Ç–Ω–æ–µ", "e": "üêæ", "r": "common"}, "fish": {"n": "–†—ã–±–∞", "e": "üêü", "r": "common"}, "bird": {"n": "–ü—Ç–∏—Ü–∞", "e": "üê¶", "r": "common"}, "human": {"n": "–ß–µ–ª–æ–≤–µ–∫", "e": "üßë", "r": "common"}, "stone": {"n": "–ö–∞–º–µ–Ω—å", "e": "üóø", "r": "common"}, "sand": {"n": "–ü–µ—Å–æ–∫", "e": "üèñÔ∏è", "r": "common"}, "glass": {"n": "–°—Ç–µ–∫–ª–æ", "e": "ü™ü", "r": "common"}, "metal": {"n": "–ú–µ—Ç–∞–ª–ª", "e": "üî©", "r": "common"}, "coal": {"n": "–£–≥–æ–ª—å", "e": "ü™µ", "r": "common"}, "oil": {"n": "–ù–µ—Ñ—Ç—å", "e": "üõ¢Ô∏è", "r": "common"}, "clay": {"n": "–ì–ª–∏–Ω–∞", "e": "üß±", "r": "common"}, "brick": {"n": "–ö–∏—Ä–ø–∏—á", "e": "üß±", "r": "common"}, "lava": {"n": "–õ–∞–≤–∞", "e": "üåã", "r": "common"}, "mountain": {"n": "–ì–æ—Ä–∞", "e": "‚õ∞Ô∏è", "r": "common"}, "canyon": {"n": "–ö–∞–Ω—å–æ–Ω", "e": "üèúÔ∏è", "r": "common"}, "diamond": {"n": "–ê–ª–º–∞–∑", "e": "üíé", "r": "common"}, "cloud": {"n": "–¢—É—á–∞", "e": "‚òÅÔ∏è", "r": "common"}, "rain": {"n": "–î–æ–∂–¥—å", "e": "üåßÔ∏è", "r": "common"}, "storm": {"n": "–®—Ç–æ—Ä–º", "e": "üå™Ô∏è", "r": "common"}, "snow": {"n": "–°–Ω–µ–≥", "e": "‚ùÑÔ∏è", "r": "common"}, "ice": {"n": "–õ—ë–¥", "e": "üßä", "r": "common"}, "wind": {"n": "–í–µ—Ç–µ—Ä", "e": "üçÉ", "r": "common"}, "pressure": {"n": "–î–∞–≤–ª–µ–Ω–∏–µ", "e": "üßØ", "r": "common"}, "heat": {"n": "–ñ–∞—Ä–∞", "e": "üî•", "r": "common"}, "energy": {"n": "–≠–Ω–µ—Ä–≥–∏—è", "e": "‚ö°Ô∏è", "r": "common"}, "lightning": {"n": "–ú–æ–ª–Ω–∏—è", "e": "üå©Ô∏è", "r": "common"}, "sun": {"n": "–°–æ–ª–Ω—Ü–µ", "e": "‚òÄÔ∏è", "r": "common"}, "moon": {"n": "–õ—É–Ω–∞", "e": "üåô", "r": "common"}, "time": {"n": "–í—Ä–µ–º—è", "e": "‚è≥", "r": "common"}, "wheat": {"n": "–ü—à–µ–Ω–∏—Ü–∞", "e": "üåæ", "r": "common"}, "flour": {"n": "–ú—É–∫–∞", "e": "ü•£", "r": "common"}, "dough": {"n": "–¢–µ—Å—Ç–æ", "e": "ü•ñ", "r": "common"}, "bread": {"n": "–•–ª–µ–±", "e": "üçû", "r": "common"}, "fruit": {"n": "–§—Ä—É–∫—Ç", "e": "üçé", "r": "common"}, "juice": {"n": "–°–æ–∫", "e": "üßÉ", "r": "common"}, "milk": {"n": "–ú–æ–ª–æ–∫–æ", "e": "ü•õ", "r": "common"}, "cheese": {"n": "–°—ã—Ä", "e": "üßÄ", "r": "common"}, "coffee": {"n": "–ö–æ—Ñ–µ", "e": "‚òï", "r": "common"}, "tea": {"n": "–ß–∞–π", "e": "üçµ", "r": "common"}, "sugar": {"n": "–°–∞—Ö–∞—Ä", "e": "üç¨", "r": "common"}, "salt": {"n": "–°–æ–ª—å", "e": "üßÇ", "r": "common"}, "meat": {"n": "–ú—è—Å–æ", "e": "ü•©", "r": "common"}, "egg": {"n": "–Ø–π—Ü–æ", "e": "ü•ö", "r": "common"}, "tool": {"n": "–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç", "e": "üõ†Ô∏è", "r": "common"}, "paper": {"n": "–ë—É–º–∞–≥–∞", "e": "üìÑ", "r": "common"}, "book": {"n": "–ö–Ω–∏–≥–∞", "e": "üìö", "r": "common"}, "screen": {"n": "–≠–∫—Ä–∞–Ω", "e": "üñ•Ô∏è", "r": "common"}, "electricity": {"n": "–≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ", "e": "üîå", "r": "common"}, "wire": {"n": "–ü—Ä–æ–≤–æ–¥", "e": "üßµ", "r": "common"}, "circuit": {"n": "–°—Ö–µ–º–∞", "e": "üß©", "r": "common"}, "battery": {"n": "–ë–∞—Ç–∞—Ä–µ—è", "e": "üîã", "r": "common"}, "engine": {"n": "–î–≤–∏–≥–∞—Ç–µ–ª—å", "e": "üõû", "r": "common"}, "car": {"n": "–ú–∞—à–∏–Ω–∞", "e": "üöó", "r": "common"}, "boat": {"n": "–õ–æ–¥–∫–∞", "e": "üõ∂", "r": "common"}, "ship": {"n": "–ö–æ—Ä–∞–±–ª—å", "e": "üö¢", "r": "common"}, "computer": {"n": "–ö–æ–º–ø—å—é—Ç–µ—Ä", "e": "üíª", "r": "common"}, "internet": {"n": "–ò–Ω—Ç–µ—Ä–Ω–µ—Ç", "e": "üåê", "r": "common"}, "app": {"n": "–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ", "e": "üì±", "r": "common"}, "robot": {"n": "–†–æ–±–æ—Ç", "e": "ü§ñ", "r": "common"}, "ai": {"n": "–ò–ò", "e": "üß†", "r": "common"}, "factory": {"n": "–§–∞–±—Ä–∏–∫–∞", "e": "üè≠", "r": "common"}, "plastic": {"n": "–ü–ª–∞—Å—Ç–∏–∫", "e": "üß¥", "r": "common"}, "glass_fiber": {"n": "–°—Ç–µ–∫–ª–æ–≤–æ–ª–æ–∫–Ω–æ", "e": "üßµ", "r": "common"}, "rocket": {"n": "–†–∞–∫–µ—Ç–∞", "e": "üöÄ", "r": "common"}, "satellite": {"n": "–°–ø—É—Ç–Ω–∏–∫", "e": "üõ∞Ô∏è", "r": "common"}, "telescope": {"n": "–¢–µ–ª–µ—Å–∫–æ–ø", "e": "üî≠", "r": "common"}, "astronaut": {"n": "–ê—Å—Ç—Ä–æ–Ω–∞–≤—Ç", "e": "üë®‚ÄçüöÄ", "r": "common"}, "planet": {"n": "–ü–ª–∞–Ω–µ—Ç–∞", "e": "ü™ê", "r": "common"}, "star": {"n": "–ó–≤–µ–∑–¥–∞", "e": "‚≠ê", "r": "common"}, "galaxy": {"n": "–ì–∞–ª–∞–∫—Ç–∏–∫–∞", "e": "üåå", "r": "common"}, "universe": {"n": "–í—Å–µ–ª–µ–Ω–Ω–∞—è", "e": "üí´", "r": "common"}, "gps": {"n": "GPS", "e": "üì°", "r": "common"}, "extra80": {"n": "–≠–ª–µ–º–µ–Ω—Ç 80", "e": "‚ú®", "r": "common"}, "extra81": {"n": "–≠–ª–µ–º–µ–Ω—Ç 81", "e": "‚ú®", "r": "common"}, "extra82": {"n": "–≠–ª–µ–º–µ–Ω—Ç 82", "e": "‚ú®", "r": "common"}, "extra83": {"n": "–≠–ª–µ–º–µ–Ω—Ç 83", "e": "‚ú®", "r": "common"}, "extra84": {"n": "–≠–ª–µ–º–µ–Ω—Ç 84", "e": "‚ú®", "r": "common"}, "extra85": {"n": "–≠–ª–µ–º–µ–Ω—Ç 85", "e": "‚ú®", "r": "common"}, "extra86": {"n": "–≠–ª–µ–º–µ–Ω—Ç 86", "e": "‚ú®", "r": "common"}, "extra87": {"n": "–≠–ª–µ–º–µ–Ω—Ç 87", "e": "‚ú®", "r": "common"}, "extra88": {"n": "–≠–ª–µ–º–µ–Ω—Ç 88", "e": "‚ú®", "r": "common"}, "extra89": {"n": "–≠–ª–µ–º–µ–Ω—Ç 89", "e": "‚ú®", "r": "common"}, "extra90": {"n": "–≠–ª–µ–º–µ–Ω—Ç 90", "e": "‚ú®", "r": "common"}, "extra91": {"n": "–≠–ª–µ–º–µ–Ω—Ç 91", "e": "‚ú®", "r": "common"}, "extra92": {"n": "–≠–ª–µ–º–µ–Ω—Ç 92", "e": "‚ú®", "r": "common"}, "extra93": {"n": "–≠–ª–µ–º–µ–Ω—Ç 93", "e": "‚ú®", "r": "common"}, "extra94": {"n": "–≠–ª–µ–º–µ–Ω—Ç 94", "e": "‚ú®", "r": "common"}, "extra95": {"n": "–≠–ª–µ–º–µ–Ω—Ç 95", "e": "‚ú®", "r": "common"}, "extra96": {"n": "–≠–ª–µ–º–µ–Ω—Ç 96", "e": "‚ú®", "r": "common"}, "extra97": {"n": "–≠–ª–µ–º–µ–Ω—Ç 97", "e": "‚ú®", "r": "common"}, "extra98": {"n": "–≠–ª–µ–º–µ–Ω—Ç 98", "e": "‚ú®", "r": "common"}, "extra99": {"n": "–≠–ª–µ–º–µ–Ω—Ç 99", "e": "‚ú®", "r": "common"}, "extra100": {"n": "–≠–ª–µ–º–µ–Ω—Ç 100", "e": "‚ú®", "r": "common"}, "extra101": {"n": "–≠–ª–µ–º–µ–Ω—Ç 101", "e": "‚ú®", "r": "common"}, "extra102": {"n": "–≠–ª–µ–º–µ–Ω—Ç 102", "e": "‚ú®", "r": "common"}, "extra103": {"n": "–≠–ª–µ–º–µ–Ω—Ç 103", "e": "‚ú®", "r": "common"}, "extra104": {"n": "–≠–ª–µ–º–µ–Ω—Ç 104", "e": "‚ú®", "r": "common"}, "extra105": {"n": "–≠–ª–µ–º–µ–Ω—Ç 105", "e": "‚ú®", "r": "common"}, "extra106": {"n": "–≠–ª–µ–º–µ–Ω—Ç 106", "e": "‚ú®", "r": "common"}, "extra107": {"n": "–≠–ª–µ–º–µ–Ω—Ç 107", "e": "‚ú®", "r": "common"}, "extra108": {"n": "–≠–ª–µ–º–µ–Ω—Ç 108", "e": "‚ú®", "r": "common"}, "extra109": {"n": "–≠–ª–µ–º–µ–Ω—Ç 109", "e": "‚ú®", "r": "common"}, "extra110": {"n": "–≠–ª–µ–º–µ–Ω—Ç 110", "e": "‚ú®", "r": "common"}, "extra111": {"n": "–≠–ª–µ–º–µ–Ω—Ç 111", "e": "‚ú®", "r": "common"}, "extra112": {"n": "–≠–ª–µ–º–µ–Ω—Ç 112", "e": "‚ú®", "r": "common"}, "extra113": {"n": "–≠–ª–µ–º–µ–Ω—Ç 113", "e": "‚ú®", "r": "common"}, "extra114": {"n": "–≠–ª–µ–º–µ–Ω—Ç 114", "e": "‚ú®", "r": "common"}, "extra115": {"n": "–≠–ª–µ–º–µ–Ω—Ç 115", "e": "‚ú®", "r": "common"}, "extra116": {"n": "–≠–ª–µ–º–µ–Ω—Ç 116", "e": "‚ú®", "r": "common"}, "extra117": {"n": "–≠–ª–µ–º–µ–Ω—Ç 117", "e": "‚ú®", "r": "common"}, "extra118": {"n": "–≠–ª–µ–º–µ–Ω—Ç 118", "e": "‚ú®", "r": "common"}, "extra119": {"n": "–≠–ª–µ–º–µ–Ω—Ç 119", "e": "‚ú®", "r": "common"}, "extra120": {"n": "–≠–ª–µ–º–µ–Ω—Ç 120", "e": "‚ú®", "r": "common"}, "extra121": {"n": "–≠–ª–µ–º–µ–Ω—Ç 121", "e": "‚ú®", "r": "common"}, "extra122": {"n": "–≠–ª–µ–º–µ–Ω—Ç 122", "e": "‚ú®", "r": "common"}, "extra123": {"n": "–≠–ª–µ–º–µ–Ω—Ç 123", "e": "‚ú®", "r": "common"}, "extra124": {"n": "–≠–ª–µ–º–µ–Ω—Ç 124", "e": "‚ú®", "r": "common"}, "extra125": {"n": "–≠–ª–µ–º–µ–Ω—Ç 125", "e": "‚ú®", "r": "common"}, "extra126": {"n": "–≠–ª–µ–º–µ–Ω—Ç 126", "e": "‚ú®", "r": "common"}, "extra127": {"n": "–≠–ª–µ–º–µ–Ω—Ç 127", "e": "‚ú®", "r": "common"}, "extra128": {"n": "–≠–ª–µ–º–µ–Ω—Ç 128", "e": "‚ú®", "r": "common"}, "extra129": {"n": "–≠–ª–µ–º–µ–Ω—Ç 129", "e": "‚ú®", "r": "common"}, "extra130": {"n": "–≠–ª–µ–º–µ–Ω—Ç 130", "e": "‚ú®", "r": "common"}, "extra131": {"n": "–≠–ª–µ–º–µ–Ω—Ç 131", "e": "‚ú®", "r": "common"}, "extra132": {"n": "–≠–ª–µ–º–µ–Ω—Ç 132", "e": "‚ú®", "r": "common"}, "extra133": {"n": "–≠–ª–µ–º–µ–Ω—Ç 133", "e": "‚ú®", "r": "common"}, "extra134": {"n": "–≠–ª–µ–º–µ–Ω—Ç 134", "e": "‚ú®", "r": "common"}, "extra135": {"n": "–≠–ª–µ–º–µ–Ω—Ç 135", "e": "‚ú®", "r": "common"}, "extra136": {"n": "–≠–ª–µ–º–µ–Ω—Ç 136", "e": "‚ú®", "r": "common"}, "extra137": {"n": "–≠–ª–µ–º–µ–Ω—Ç 137", "e": "‚ú®", "r": "common"}, "extra138": {"n": "–≠–ª–µ–º–µ–Ω—Ç 138", "e": "‚ú®", "r": "common"}, "extra139": {"n": "–≠–ª–µ–º–µ–Ω—Ç 139", "e": "‚ú®", "r": "common"}, "extra140": {"n": "–≠–ª–µ–º–µ–Ω—Ç 140", "e": "‚ú®", "r": "common"}, "extra141": {"n": "–≠–ª–µ–º–µ–Ω—Ç 141", "e": "‚ú®", "r": "common"}, "extra142": {"n": "–≠–ª–µ–º–µ–Ω—Ç 142", "e": "‚ú®", "r": "common"}, "extra143": {"n": "–≠–ª–µ–º–µ–Ω—Ç 143", "e": "‚ú®", "r": "common"}, "extra144": {"n": "–≠–ª–µ–º–µ–Ω—Ç 144", "e": "‚ú®", "r": "common"}, "extra145": {"n": "–≠–ª–µ–º–µ–Ω—Ç 145", "e": "‚ú®", "r": "common"}}, "recipes": {"earth+fire": "lava", "fire+water": "steam", "earth+water": "mud", "air+earth": "dust", "air+water": "rain", "air+fire": "energy", "lava+water": "stone", "air+lava": "stone", "earth+lava": "volcano", "air+stone": "sand", "fire+sand": "glass", "air+air": "pressure", "earth+pressure": "mountain"}};
const PRICE=10;
const SAVE_KEY='elementix-v126c';
const BASE=DATA.base, EXTRA=DATA.extra, RECIPES=DATA.recipes;
const ALL=new Map(); BASE.forEach(b=>ALL.set(b.id,b)); Object.entries(EXTRA).forEach(([id,m])=>ALL.set(id,{id,n:m.n,e:m.e,r:m.r}));
const DEFAULT_TOAST_MS = 3400;

const $=id=>document.getElementById(id);
const grid=$('grid'),openCount=$('openCount'),totalCount=$('totalCount'),bA=$('bA'),bB=$('bB'),crumbs=$('crumbs');

let state={disc:new Set(BASE.map(x=>x.id)),order:[...BASE.map(x=>x.id)],a:null,b:null,stars:20};
try{ const raw=localStorage.getItem(SAVE_KEY); if(raw){ const o=JSON.parse(raw); state.disc=new Set(o.d||BASE.map(x=>x.id)); state.order=o.o||[...state.disc]; state.a=o.a||null; state.b=o.b||null; }}catch{}
function save(){ localStorage.setItem(SAVE_KEY, JSON.stringify({d:[...state.disc],o:state.order,a:state.a,b:state.b})); }

function asList(q=''){ q=(q||'').toLowerCase(); const opened=[...state.order].filter(id=>state.disc.has(id) && ALL.get(id).n.toLowerCase().includes(q)); const locked=[...ALL.keys()].filter(id=>!state.disc.has(id) && ALL.get(id).n.toLowerCase().includes(q)); return opened.concat(locked); }
function cardHTML(id,opened){ const it=ALL.get(id); return `<div class="card ${opened?'':'locked'}" data-id="${id}" draggable="${opened}"><div class="tag">–û–±—ã—á–Ω—ã–π</div><div class="emoji">${opened?it.e:'‚ùì'}</div><div class="name">${opened?it.n:'???'}</div></div>`; }
function renderDex(q=''){ grid.innerHTML=''; for(const id of asList(q)){ const opened=state.disc.has(id); const w=document.createElement('div'); w.innerHTML=cardHTML(id,opened); const card=w.firstChild; if(opened){ card.addEventListener('click',()=>selectByClick(id)); card.addEventListener('dragstart',e=>{ e.dataTransfer.setData('text/plain',id); }); } grid.appendChild(card);} openCount.textContent=state.disc.size; totalCount.textContent=ALL.size; }
function bowlBlock(id){ if(!id) return '<div class="hint">–ü–µ—Ä–µ—Ç–∞—â–∏ –∏–ª–∏ –∫–ª–∏–∫–Ω–∏ –∫–∞—Ä—Ç–æ—á–∫—É</div>'; const it=ALL.get(id); return `<div class="selection"><div class="emoji">${it.e}</div><div class="name">${it.n}</div></div>`; }
function renderBowls(){ bA.innerHTML=bowlBlock(state.a); bB.innerHTML=bowlBlock(state.b); renderCrumbs(); }
[bA,bB].forEach((b,ix)=>{ b.addEventListener('dragover',e=>e.preventDefault()); b.addEventListener('drop',e=>{ e.preventDefault(); const id=e.dataTransfer.getData('text/plain'); if(ix===0) state.a=id; else state.b=id; renderBowls(); save(); }); });
function selectByClick(id){ if(!state.a) state.a=id; else if(!state.b) state.b=id; else { state.a=id; state.b=null; } renderBowls(); save(); }
$('search').addEventListener('input',(()=>{ let t; return ()=>{ clearTimeout(t); t=setTimeout(()=>renderDex($('search').value),120);} })());
$('reset').addEventListener('click',()=>{ localStorage.removeItem(SAVE_KEY); location.reload(); });

function renderCrumbs(){ const parts=[]; if(state.a){ const it=ALL.get(state.a); parts.push(`<div class="token"><div class="emo">${it.e}</div></div>`);} if(state.b){ const it=ALL.get(state.b); parts.push(`<div class="token"><div class="emo">${it.e}</div></div>`);} crumbs.innerHTML = parts.join('') || '<div style="color:#9fb0bf;font-size:12px;padding:2px 6px">–í—ã–±–µ—Ä–∏ 2 —ç–ª–µ–º–µ–Ω—Ç–∞‚Ä¶</div>'; }

function toast(msg,ms=DEFAULT_TOAST_MS){ const t=document.createElement('div'); t.className='toast'; t.textContent=msg; document.body.appendChild(t); setTimeout(()=>t.remove(),ms); }

$('clear').addEventListener('click',()=>{ state.a=null; state.b=null; renderBowls(); save(); });

$('mix').addEventListener('click',()=>{
  if(!state.a||!state.b){ toast('–ù—É–∂–Ω–æ 2 —ç–ª–µ–º–µ–Ω—Ç–∞'); return; }
  const key=[state.a,state.b].sort().join('+'); const out=RECIPES[key];
  if(!out){ toast('–ü—É—Å—Ç–∞—è —Ä–µ–∞–∫—Ü–∏—è‚Ä¶'); return; }
  const wasNew=!state.disc.has(out); state.disc.add(out); if(wasNew){ state.order=state.order.filter(x=>x!==out); state.order.push(out); }
  state.a=null; state.b=null; renderBowls(); renderDex($('search').value); const it=ALL.get(out)||{e:'‚ú®',n:out}; toast((wasNew?'–ù–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç: ':'')+it.e+' '+it.n); save();
});

function init(){ renderDex(); renderBowls(); }
init();
</script>
</body>
</html>
